"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[855],{9192:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"deployment/helm","title":"Helm","description":"Deploy Expo Open OTA using Helm, a package manager for Kubernetes.","source":"@site/docs/deployment/helm.mdx","sourceDirName":"deployment","slug":"/deployment/helm","permalink":"/expo-open-ota/docs/deployment/helm","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/deployment/helm.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docSidebar","previous":{"title":"Railway","permalink":"/expo-open-ota/docs/deployment/railway"},"next":{"title":"Custom Deployment","permalink":"/expo-open-ota/docs/deployment/custom"}}');var i=s(4848),o=s(8453);const l={sidebar_position:2},d="Helm",c={},t=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Conditional Logic for Environment Variables",id:"conditional-logic-for-environment-variables",level:3},{value:"Deployment",id:"deployment",level:3},{value:"Ingress Configuration",id:"ingress-configuration",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"helm",children:"Helm"})}),"\n",(0,i.jsxs)(n.p,{children:["Deploy ",(0,i.jsx)(n.strong,{children:"Expo Open OTA"})," using Helm, a package manager for Kubernetes."]}),"\n",(0,i.jsxs)(n.p,{children:["A ready-to-use Helm chart is available to deploy ",(0,i.jsx)(n.strong,{children:"Expo Open OTA"})," on your Kubernetes cluster."]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.p,{children:["A running Kubernetes cluster and Helm installed on your local machine are required to deploy the application.\nIf you are not familiar with Helm or Kubernetes, we recommend you to deploy the server with ",(0,i.jsx)(n.a,{href:"/docs/deployment/custom",children:"custom docker deployment"})," or ",(0,i.jsx)(n.a,{href:"/docs/deployment/railway",children:"railway"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Clone the repository and navigate to the ",(0,i.jsx)(n.code,{children:"helm"})," directory."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/axelmarciano/expo-open-ota\ncd expo-open-ota/helm\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["The Helm chart uses a set of configurable values defined in ",(0,i.jsx)(n.code,{children:"values.yaml"}),". These values can be overridden by passing a custom ",(0,i.jsx)(n.code,{children:"values.yaml"})," file when deploying the chart."]}),"\n",(0,i.jsx)(n.h3,{id:"conditional-logic-for-environment-variables",children:"Conditional Logic for Environment Variables"}),"\n",(0,i.jsx)(n.p,{children:"The environment variables used by the application depend on the following key settings:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"secretName"})}),": If defined, environment variables are loaded from the specified Kubernetes secret instead of being set directly."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"storageMode"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"s3"}),": Requires ",(0,i.jsx)(n.code,{children:"AWS_REGION"})," and ",(0,i.jsx)(n.code,{children:"S3_BUCKET_NAME"})," to be set."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"local"}),": Requires ",(0,i.jsx)(n.code,{children:"LOCAL_BUCKET_BASE_PATH"})," to be set."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"keysStorageType"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"aws-secrets-manager"}),": Requires AWS Secrets Manager variables (",(0,i.jsx)(n.code,{children:"AWSSM_EXPO_PUBLIC_KEY_SECRET_ID"}),", ",(0,i.jsx)(n.code,{children:"AWSSM_EXPO_PRIVATE_KEY_SECRET_ID"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"local"}),": Requires local key paths (",(0,i.jsx)(n.code,{children:"PRIVATE_LOCAL_EXPO_KEY_PATH"}),", ",(0,i.jsx)(n.code,{children:"PUBLIC_LOCAL_EXPO_KEY_PATH"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"environment"}),": Requires base64-encoded keys (",(0,i.jsx)(n.code,{children:"PUBLIC_EXPO_KEY_B64"}),", ",(0,i.jsx)(n.code,{children:"PRIVATE_EXPO_KEY_B64"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"useCloudfrontRedirect"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"true"}),", requires ",(0,i.jsx)(n.code,{children:"CLOUDFRONT_DOMAIN"}),", ",(0,i.jsx)(n.code,{children:"CLOUDFRONT_KEY_PAIR_ID"}),", and a CloudFront private key (",(0,i.jsx)(n.code,{children:"CLOUDFRONT_PRIVATE_KEY_B64"}),", ",(0,i.jsx)(n.code,{children:"PRIVATE_CLOUDFRONT_KEY_PATH"}),", or ",(0,i.jsx)(n.code,{children:"AWSSM_CLOUDFRONT_PRIVATE_KEY_SECRET_ID"}),", depending on ",(0,i.jsx)(n.code,{children:"keysStorageType"}),")."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"useAWSAccessKeys"})}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"true"}),", requires ",(0,i.jsx)(n.code,{children:"AWS_ACCESS_KEY_ID"})," and ",(0,i.jsx)(n.code,{children:"AWS_SECRET_ACCESS_KEY"})," to be set."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"deployment",children:"Deployment"}),"\n",(0,i.jsx)(n.p,{children:"To install the Helm chart with default values:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install expo-open-ota -n NAMESPACE ./chart\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To override values, create a custom ",(0,i.jsx)(n.code,{children:"my-values.yaml"})," file and run:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install expo-open-ota ./chart -n NAMESPACE -f my-values.yaml\n"})}),"\n",(0,i.jsx)(n.p,{children:"To upgrade an existing release:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade expo-open-ota -n NAMESPACE ./chart -f my-values.yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["For additional configuration details, refer to the ",(0,i.jsx)(n.a,{href:"/docs/environment",children:"Environment Variables"})," documentation."]}),"\n",(0,i.jsx)(n.h2,{id:"ingress-configuration",children:"Ingress Configuration"}),"\n",(0,i.jsx)(n.p,{children:"The Ingress configuration is crucial for exposing Expo Open OTA through a specific domain and must match the BASE_URL defined in the application."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>d});var r=s(6540);const i={},o=r.createContext(i);function l(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);